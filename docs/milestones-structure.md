# üéØ KGV-Projekt Meilenstein-Struktur

## üìä √úbersicht der Meilensteine

Basierend auf der Migrationsstrategie und den Business Requirements wurden die Meilensteine so definiert, dass jeder Phase klare, messbare Ziele hat und die Issues in maximal 1-2 Tage Entwicklungszeit aufgeteilt sind.

---

## üèóÔ∏è Meilenstein 1: Foundation (M1)

### **üìã Projekt-Metadaten**
- **Zeitraum**: Wochen 1-10 (Q1 2025)
- **Entwicklertage**: 40 Tage
- **Issues Gesamt**: 20 
- **Team-Fokus**: 2 Backend + 2 Frontend Entwickler

### **üéØ Hauptziele**
- ‚úÖ Solide technische Grundlagen schaffen
- ‚úÖ Domain Model sicher implementieren (CLAUDE.md konform)
- ‚úÖ Authentication & Authorization System
- ‚úÖ Basic API Endpoints f√ºr MVP

### **üìà Erfolgskriterien**
- [ ] Domain Model vollst√§ndig implementiert und getestet
- [ ] JWT Authentication funktionsf√§hig
- [ ] 10 Core API Endpoints verf√ºgbar
- [ ] Angular Projekt-Grundlagen erstellt
- [ ] CI/CD Pipeline l√§uft
- [ ] >95% Domain Guard Compliance

---

## üåü Meilenstein 1 - Detaillierte Issue-Planung

### **üèõÔ∏è Domain & Architecture Block (5 Issues, 7.5 Tage)**

#### **Issue #1: Domain Model Foundation**
**Titel**: `feat: Domain Value Objects - Aktenzeichen, PersonData, Address`
**Assignee**: Backend Lead Developer
**Aufwand**: 2 Tage
**Dependencies**: Keine

**Backend Tasks (2 Tage)**:
- [ ] Aktenzeichen Value Object implementieren
  - Pattern-Validation: `^(32\.2|33\.2)\s+(\d+)\s+(\d{4})$`
  - Factory Methods: Create() und Parse()
  - Business Rules: ListType-Mapping
- [ ] PersonData Value Object erstellen
  - Validation: Min 18 Jahre, Email-Format
  - Computed Properties: FullName
  - Immutability gew√§hrleisten
- [ ] Address Value Object implementieren  
  - Deutsche PLZ-Validierung (5 Ziffern)
  - Normalisierte Datenstruktur
  - FullAddress computed property
- [ ] Unit Tests f√ºr alle Value Objects (>90% Coverage)
- [ ] Domain Guard Validation durchlaufen

**Acceptance Criteria**:
- ‚úÖ Alle Value Objects sind immutable (sealed records)
- ‚úÖ Pattern-Matching f√ºr Aktenzeichen funktioniert
- ‚úÖ Validierung wirft korrekte Exceptions
- ‚úÖ Unit Tests decken alle Business Rules ab
- ‚úÖ Keine √Ñnderungen an CLAUDE.md-gesch√ºtzten Bereichen

---

#### **Issue #2: Entity Framework Foundation** 
**Titel**: `feat: EF Core Setup - DbContext, Entities, Migrations`
**Assignee**: Backend Developer
**Aufwand**: 1 Tag
**Dependencies**: #1

**Backend Tasks (1 Tag)**:
- [ ] KgvDbContext erstellen mit DbSets
- [ ] Entity-Konfigurationen f√ºr Value Objects
- [ ] Application Entity mit Status-Enums
- [ ] WaitingList und WaitingListEntry Entities
- [ ] Initial Migration erstellen
- [ ] Seed-Data f√ºr Gemarkungen

**Acceptance Criteria**:
- ‚úÖ Migrations laufen ohne Fehler
- ‚úÖ Value Objects werden korrekt serialisiert/deserialisiert
- ‚úÖ Foreign Key Constraints sind definiert
- ‚úÖ Seed-Data wird korrekt geladen

---

#### **Issue #3: Repository Pattern Implementation**
**Titel**: `feat: Repository Pattern - Generic Repository + Unit of Work`
**Assignee**: Backend Developer  
**Aufwand**: 1 Tag
**Dependencies**: #2

**Backend Tasks (1 Tag)**:
- [ ] Generic Repository Interface und Implementation
- [ ] Specialized Repositories: ApplicationRepository, WaitingListRepository
- [ ] Unit of Work Pattern implementieren
- [ ] Repository Extensions f√ºr complex queries
- [ ] Integration Tests f√ºr Repository

**Acceptance Criteria**:
- ‚úÖ Generic Repository funktioniert f√ºr alle Entities
- ‚úÖ Complex Business Queries sind implementiert
- ‚úÖ Unit of Work koordiniert Transaktionen korrekt
- ‚úÖ Integration Tests bestehen

---

#### **Issue #4: CQRS Infrastructure Setup**
**Titel**: `feat: CQRS Setup - MediatR Commands/Queries Infrastructure`
**Assignee**: Backend Lead Developer
**Aufwand**: 1.5 Tage  
**Dependencies**: #3

**Backend Tasks (1.5 Tage)**:
- [ ] MediatR Package konfigurieren
- [ ] Base Command/Query/Handler Classes
- [ ] Validation Pipeline mit FluentValidation
- [ ] Logging und Error-Handling Pipeline
- [ ] Example Command/Query f√ºr Application CRUD
- [ ] Unit Tests f√ºr Pipeline-Behavior

**Acceptance Criteria**:
- ‚úÖ Commands und Queries funktionieren √ºber MediatR
- ‚úÖ Validation Pipeline f√§ngt alle Validierungsfehler
- ‚úÖ Logging erfasst alle Command/Query-Aktivit√§ten
- ‚úÖ Error-Handling ist konsistent

---

#### **Issue #5: Domain Events Infrastructure**
**Titel**: `feat: Domain Events - Event Publishing/Handling Infrastructure`
**Assignee**: Backend Developer
**Aufwand**: 1.5 Tage
**Dependencies**: #4

**Backend Tasks (1.5 Tage)**:
- [ ] IDomainEvent Interface definieren
- [ ] Domain Event Publisher implementieren
- [ ] Event Handler Registry
- [ ] ApplicationCreated, ApplicationStatusChanged Events
- [ ] Event Sourcing Vorbereitungen (Versioning)
- [ ] Integration Tests f√ºr Event Flow

**Acceptance Criteria**:
- ‚úÖ Domain Events werden korrekt publiziert
- ‚úÖ Event Handler werden automatisch registriert
- ‚úÖ Event Versioning ist vorbereitet
- ‚úÖ Events sind testbar und nachverfolgbar

---

### **üîê Authentication & Security Block (4 Issues, 5.5 Tage)**

#### **Issue #6: JWT Authentication System**
**Titel**: `feat: JWT Authentication - Token generation, validation, refresh`
**Assignee**: Backend Lead Developer
**Aufwand**: 2 Tage
**Dependencies**: #2

**Backend Tasks (1 Tag)**:
- [ ] JWT Token-Generierung implementieren
- [ ] Token-Validation Middleware
- [ ] Refresh Token Mechanismus
- [ ] Claims-based Authorization Setup
- [ ] Login/Logout Endpoints
- [ ] Token Blacklisting f√ºr Logout

**Frontend Tasks (1 Tag)**:
- [ ] AuthService f√ºr Token-Management
- [ ] HTTP Interceptor f√ºr Authorization Headers
- [ ] Token-Refresh Logic
- [ ] Login/Logout Components (basic)
- [ ] Route Guards implementieren

**Acceptance Criteria**:
- ‚úÖ JWT Tokens werden korrekt generiert und validiert
- ‚úÖ Refresh Token funktioniert automatisch
- ‚úÖ Authorization Headers werden automatisch gesetzt
- ‚úÖ Expired Tokens werden automatisch erneuert
- ‚úÖ Logout invalidiert Tokens serverseitig

---

#### **Issue #7: User Management Foundation**
**Titel**: `feat: User Management - User Entity, basic CRUD`
**Assignee**: Backend Developer
**Aufwand**: 1 Tag  
**Dependencies**: #6

**Backend Tasks (1 Tag)**:
- [ ] User Entity mit Rollen definieren
- [ ] User Repository und Services
- [ ] Password-Hashing mit bcrypt
- [ ] User CRUD Commands/Queries
- [ ] Basic User Management API Endpoints
- [ ] Unit Tests f√ºr User Services

**Acceptance Criteria**:
- ‚úÖ User k√∂nnen erstellt, gelesen, aktualisiert werden
- ‚úÖ Passw√∂rter sind sicher gehasht
- ‚úÖ User-Rollen funktionieren korrekt
- ‚úÖ API Endpoints sind dokumentiert

---

#### **Issue #8: Role-based Authorization**
**Titel**: `feat: Role-based Authorization - Roles, Permissions, Policies`
**Assignee**: Backend Developer
**Aufwand**: 1.5 Tage
**Dependencies**: #7

**Backend Tasks (1 Tag)**:
- [ ] Role und Permission Entities
- [ ] Policy-based Authorization Setup
- [ ] Custom Authorization Attributes
- [ ] Admin, Sachbearbeiter, B√ºrger Rollen
- [ ] Permission-Matrix implementieren

**Frontend Tasks (0.5 Tage)**:
- [ ] Role-based Route Guards
- [ ] Component-Level Permission Checks
- [ ] UI Element Visibility basierend auf Rollen

**Acceptance Criteria**:
- ‚úÖ Verschiedene Rollen haben unterschiedliche Berechtigungen
- ‚úÖ UI passt sich basierend auf Benutzerrolle an
- ‚úÖ API Endpoints sind rollenbasiert gesch√ºtzt
- ‚úÖ Authorization Policies funktionieren korrekt

---

#### **Issue #9: Security Middleware**
**Titel**: `feat: Security Middleware - Rate limiting, CORS, Headers`
**Assignee**: Backend Developer
**Aufwand**: 1 Tag
**Dependencies**: #8

**Backend Tasks (1 Tag)**:
- [ ] Rate Limiting implementieren
- [ ] CORS Policy konfigurieren  
- [ ] Security Headers Middleware
- [ ] Request/Response Logging
- [ ] API Key Validation (f√ºr externe APIs)
- [ ] Security Integration Tests

**Acceptance Criteria**:
- ‚úÖ Rate Limiting verhindert API Abuse
- ‚úÖ CORS ist korrekt f√ºr Frontend konfiguriert
- ‚úÖ Security Headers sind gesetzt
- ‚úÖ Logging erfasst sicherheitsrelevante Events

---

### **üåê Core API Endpoints Block (6 Issues, 8.5 Tage)**

#### **Issue #10: Application CRUD API**
**Titel**: `feat: Application Management API - Complete CRUD with validation`
**Assignee**: Full-Stack Developer 1
**Aufwand**: 2 Tage
**Dependencies**: #5, #9

**Backend Tasks (1.5 Tage)**:
- [ ] Application Controller mit allen CRUD Endpoints
- [ ] CreateApplicationCommand mit Validation
- [ ] UpdateApplicationCommand mit Business Rules
- [ ] GetApplicationQuery mit Paging/Filtering
- [ ] DeleteApplicationCommand (Soft Delete)
- [ ] Integration Tests f√ºr alle Endpoints
- [ ] OpenAPI/Swagger Dokumentation

**Frontend Tasks (0.5 Tage)**:
- [ ] ApplicationService f√ºr API Calls
- [ ] Basic DTOs/Models definieren
- [ ] Error-Handling f√ºr API Responses
- [ ] Loading States Management

**Acceptance Criteria**:
- ‚úÖ CRUD Operationen funktionieren korrekt
- ‚úÖ Business Rules werden eingehalten
- ‚úÖ API ist vollst√§ndig dokumentiert
- ‚úÖ Frontend kann erfolgreich API aufrufen
- ‚úÖ Error-Handling funktioniert durchg√§ngig

---

#### **Issue #11: Application Status API**
**Titel**: `feat: Application Status Management - Status changes with validation`
**Assignee**: Backend Developer
**Aufwand**: 1.5 Tage
**Dependencies**: #10

**Backend Tasks (1.5 Tage)**:
- [ ] ChangeApplicationStatusCommand implementieren
- [ ] Status-Transition-Validierung (State Machine)
- [ ] ApplicationStatusChanged Domain Event
- [ ] Status History Tracking
- [ ] GetApplicationStatusHistoryQuery
- [ ] Status Change API Endpoints

**Acceptance Criteria**:
- ‚úÖ Nur g√ºltige Status-√úberg√§nge sind erlaubt
- ‚úÖ Status-Geschichte wird vollst√§ndig protokolliert
- ‚úÖ Domain Events werden bei Status-√Ñnderungen gefeuert
- ‚úÖ API verhindert ung√ºltige √úberg√§nge

---

#### **Issue #12: Person Management API**  
**Titel**: `feat: Person Management API - Person CRUD with validation`
**Assignee**: Backend Developer
**Aufwand**: 1 Tag
**Dependencies**: #1

**Backend Tasks (1 Tag)**:
- [ ] Person Controller und Endpoints
- [ ] PersonData Validation Rules
- [ ] Duplicate Person Detection
- [ ] Person Search/Filter Functionality
- [ ] Person-Address Relationship Management
- [ ] Unit Tests f√ºr Person-spezifische Logic

**Acceptance Criteria**:
- ‚úÖ Person-Daten werden korrekt validiert
- ‚úÖ Duplikate werden erkannt und verhindert
- ‚úÖ Search/Filter funktioniert performant
- ‚úÖ PersonData Value Object Integration

---

#### **Issue #13: Waiting List API**
**Titel**: `feat: Waiting List Management - List management, ranking`
**Assignee**: Full-Stack Developer 2
**Aufwand**: 2 Tage
**Dependencies**: #1, #10

**Backend Tasks (1.5 Tage)**:
- [ ] WaitingList Controller mit CRUD
- [ ] AddToWaitingListCommand
- [ ] FIFO Ranking Algorithm implementieren
- [ ] RemoveFromWaitingListCommand mit Re-ranking
- [ ] GetWaitingListQuery mit Paging
- [ ] Ranking Recalculation Service
- [ ] Integration Tests f√ºr Ranking Logic

**Frontend Tasks (0.5 Tage)**:
- [ ] WaitingListService f√ºr API Integration
- [ ] Basic List Display Component
- [ ] Ranking Position Display
- [ ] Real-time Updates Setup (WebSocket Vorbereitung)

**Acceptance Criteria**:
- ‚úÖ FIFO Ranking funktioniert korrekt
- ‚úÖ Ranking wird bei √Ñnderungen automatisch aktualisiert
- ‚úÖ Frontend zeigt aktuelle Ranking Position
- ‚úÖ Performance ist auch bei gro√üen Listen gut

---

#### **Issue #14: User Management API**
**Titel**: `feat: Admin User Management API - Admin functions`
**Assignee**: Backend Developer
**Aufwand**: 1 Tag
**Dependencies**: #8

**Backend Tasks (1 Tag)**:
- [ ] Admin-specific User Management Endpoints
- [ ] User Role Assignment API
- [ ] User Activity Tracking
- [ ] Password Reset Functionality
- [ ] User Account Activation/Deactivation
- [ ] Admin Dashboard Statistics API

**Acceptance Criteria**:
- ‚úÖ Nur Admins k√∂nnen User-Management zugreifen
- ‚úÖ Role-Assignment funktioniert korrekt
- ‚úÖ Password-Reset ist sicher implementiert
- ‚úÖ User-Aktivit√§ten werden geloggt

---

#### **Issue #15: Health Check API**
**Titel**: `feat: Health Check API - Monitoring, diagnostics`
**Assignee**: Backend Developer
**Aufwand**: 0.5 Tage
**Dependencies**: #2

**Backend Tasks (0.5 Tage)**:
- [ ] Basic Health Check Endpoint (/health)
- [ ] Database Connectivity Check
- [ ] External Services Health Check
- [ ] Version Information Endpoint
- [ ] System Status Dashboard API
- [ ] Monitoring Integration (Ê∫ñÂÇô)

**Acceptance Criteria**:
- ‚úÖ Health Check gibt korrekten System Status zur√ºck
- ‚úÖ Database und externe Services werden gepr√ºft
- ‚úÖ Monitoring kann System-Health abrufen
- ‚úÖ API ist f√ºr Load Balancer konfiguriert

---

### **üñ•Ô∏è Frontend Foundation Block (5 Issues, 6.5 Tage)**

#### **Issue #16: Angular Project Setup**
**Titel**: `feat: Angular Foundation - CLI, Material, Routing`
**Assignee**: Frontend Lead Developer
**Aufwand**: 1 Tag
**Dependencies**: Keine

**Frontend Tasks (1 Tag)**:
- [ ] Angular CLI Projekt erstellen (v18+)
- [ ] Angular Material Installation und Konfiguration
- [ ] Basic Routing Setup mit Lazy Loading
- [ ] SCSS Configuration und Theme Setup
- [ ] Environment-Konfiguration (dev/prod)
- [ ] Build-Optimization (Bundle Analyzer)
- [ ] PWA Service Worker Vorbereitung

**Acceptance Criteria**:
- ‚úÖ Angular Projekt kompiliert ohne Warnings
- ‚úÖ Angular Material ist integriert und funktioniert
- ‚úÖ Routing funktioniert mit Lazy Loading
- ‚úÖ Build ist f√ºr Produktion optimiert
- ‚úÖ Theme ist konfigurierbar

---

#### **Issue #17: Authentication Module**
**Titel**: `feat: Authentication Module - Login, JWT handling, Guards`
**Assignee**: Frontend Developer
**Aufwand**: 2 Tage
**Dependencies**: #16, #6

**Frontend Tasks (2 Tage)**:
- [ ] Login Component mit Reactive Forms
- [ ] AuthService mit JWT Token Management
- [ ] HTTP Interceptor f√ºr Token-Injection
- [ ] AuthGuard f√ºr Route Protection
- [ ] Token-Refresh-Logic implementieren
- [ ] Logout-Functionality
- [ ] Login State Management (NgRx Setup)
- [ ] Component Tests f√ºr Auth Module

**Acceptance Criteria**:
- ‚úÖ Login funktioniert mit Backend JWT API
- ‚úÖ Token werden automatisch in Requests eingef√ºgt
- ‚úÖ Route Guards sch√ºtzen gesch√ºtzte Bereiche
- ‚úÖ Token werden automatisch erneuert
- ‚úÖ Logout entfernt Token korrekt

---

#### **Issue #18: Main Layout Components**
**Titel**: `feat: Main Layout - Header, Navigation, Footer`
**Assignee**: Frontend Developer
**Aufwand**: 1 Tag
**Dependencies**: #17

**Frontend Tasks (1 Tag)**:
- [ ] App Layout Component mit Angular Material
- [ ] Header mit User-Info und Logout
- [ ] Navigation Sidebar mit Role-based Menu
- [ ] Footer mit System-Infos
- [ ] Responsive Breakpoints f√ºr Mobile
- [ ] Theme Toggle (Light/Dark Mode)
- [ ] Loading Indicator Component

**Acceptance Criteria**:
- ‚úÖ Layout ist responsive auf allen Ger√§ten
- ‚úÖ Navigation passt sich an Benutzerrolle an
- ‚úÖ Theme Toggle funktioniert
- ‚úÖ User-Informationen werden korrekt angezeigt

---

#### **Issue #19: Form Infrastructure**
**Titel**: `feat: Form Infrastructure - Reactive forms, validation`
**Assignee**: Frontend Lead Developer
**Aufwand**: 1.5 Tage
**Dependencies**: #18

**Frontend Tasks (1.5 Tage)**:
- [ ] Base Form Component mit Validation
- [ ] Custom Form Controls f√ºr KGV-spezifische Felder
- [ ] Aktenzeichen Input Component
- [ ] PersonData Form Component
- [ ] Address Form Component mit PLZ-Lookup
- [ ] Form Validation Service
- [ ] Error-Message Display System
- [ ] Form Components Testing

**Acceptance Criteria**:
- ‚úÖ Reactive Forms funktionieren mit Validation
- ‚úÖ Custom Controls sind wiederverwendbar
- ‚úÖ Error Messages sind benutzerfreundlich
- ‚úÖ PLZ-Lookup funktioniert in Echtzeit
- ‚úÖ Forms sind barrierefrei (BITV 2.0)

---

#### **Issue #20: HTTP Interceptor Setup**
**Titel**: `feat: HTTP Infrastructure - Error handling, loading states`
**Assignee**: Frontend Developer
**Aufwand**: 1 Tag  
**Dependencies**: #17

**Frontend Tasks (1 Tag)**:
- [ ] Global Error Handling Interceptor
- [ ] Loading State Interceptor
- [ ] API Base URL Configuration
- [ ] Retry Logic f√ºr fehlgeschlagene Requests
- [ ] Global Error Notification Service
- [ ] Request/Response Logging (Development)
- [ ] HTTP Client Testing Setup

**Acceptance Criteria**:
- ‚úÖ HTTP Errors werden benutzerfreundlich angezeigt
- ‚úÖ Loading States werden automatisch gemanagt
- ‚úÖ Fehlgeschlagene Requests werden automatisch wiederholt
- ‚úÖ API Communication ist robust und testbar

---

## üìä Meilenstein 1 - Metriken und Erfolgsmessung

### **Quantitative Erfolgskriterien**
- ‚úÖ **20 von 20 Issues** erfolgreich abgeschlossen
- ‚úÖ **>95% Test Coverage** f√ºr Domain Model
- ‚úÖ **100% Domain Guard Compliance** (keine Violations)
- ‚úÖ **API Response Time** < 500ms f√ºr alle Endpoints
- ‚úÖ **Frontend Build Time** < 60 Sekunden
- ‚úÖ **Zero Critical Security Issues** in Audit

### **Qualitative Erfolgskriterien**
- ‚úÖ **Domain Model** entspricht exakt der Dokumentation
- ‚úÖ **Authentication** ist produktionsbereit und sicher
- ‚úÖ **API Architecture** ist erweiterbar und maintainable
- ‚úÖ **Frontend Foundation** erm√∂glicht effiziente Feature-Entwicklung
- ‚úÖ **Team Velocity** ist stabil und vorhersagbar

### **Go/No-Go Kriterien f√ºr Meilenstein 2**
- üü¢ **Go**: Alle Issues abgeschlossen, Tests bestehen, Stakeholder zufrieden
- üî¥ **No-Go**: >2 Issues offen, Domain Guard Violations, kritische Bugs

---

*Diese detaillierte Planung f√ºr Meilenstein 1 dient als Vorlage f√ºr die weiteren Meilensteine und gew√§hrleistet, dass jedes Issue klar definiert, sch√§tzbar und in maximal 2 Tagen umsetzbar ist.*